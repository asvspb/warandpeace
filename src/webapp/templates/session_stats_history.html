{% extends "base.html" %}

{% block title %}История статистики - {{ super() }}{% endblock %}

{% block content %}
<header style="margin-bottom: 16px; display:flex; align-items:center; gap:12px;">
  <h1 style="margin:0;">История статистики</h1>
  <form method="get" action="/stats/history" style="margin-left:auto;">
    <label class="muted">Дней:
      <input type="number" name="days" min="1" max="90" value="{{ days or 14 }}" style="width:72px;">
    </label>
    <button type="submit">Показать</button>
  </form>
</header>

<section>
  <table class="table" style="width:100%; border-collapse: collapse;">
    <thead>
      <tr>
        <th style="text-align:left; padding:8px; border-bottom:1px solid var(--border);">День (UTC)</th>
        <th style="text-align:right; padding:8px; border-bottom:1px solid var(--border);">Исходящие HTTP</th>
        <th style="text-align:right; padding:8px; border-bottom:1px solid var(--border);">Обработано новостей</th>
        <th style="text-align:right; padding:8px; border-bottom:1px solid var(--border);">Токены prompt</th>
        <th style="text-align:right; padding:8px; border-bottom:1px solid var(--border);">Токены completion</th>
      </tr>
    </thead>
    <tbody>
      {% for r in hist.days %}
      <tr>
        <td style="padding:8px;">{{ r.day }}</td>
        <td style="padding:8px; text-align:right;">{{ r.http | int }}</td>
        <td style="padding:8px; text-align:right;">{{ r.articles | int }}</td>
        <td style="padding:8px; text-align:right;">{{ r.tokens_in | int }}</td>
        <td style="padding:8px; text-align:right;">{{ r.tokens_out | int }}</td>
      </tr>
      {% endfor %}
      {% if not hist.days %}
      <tr>
        <td colspan="5" class="muted" style="padding:8px;">Нет данных</td>
      </tr>
      {% endif %}
    </tbody>
  </table>
</section>

<p style="margin-top:12px;"><a href="/stats">← Назад</a></p>
{% endblock %}
